{% extends "admin/base_site.html" %}
{% load i18n %}

{% block breadcrumbs%}
<div class="breadcrumbs">
    <a href="{% url 'admin:index' %}">Home</a> &rsaquo;
    <a href="{% url 'admin:index' %}">Rotmic</a> &rsaquo;
    <a href="{% url 'admin:rotmic_'|add:model_name|add:'_changelist' %}">{% block object-class1 %}{{verbose_name|capfirst}}s{% endblock %}</a> &rsaquo;
    Upload Table
</div>
{% endblock %}


{% block content %}        

    <h2>Bulk upload of {{verbose_name}}s</h2>
    
    <p>
    This form allows you to create several <b>new</b> {{verbose_name}} entries
    at once. This is how it works:
    <ol>
        <li>Click to download the Excel template file.</li>

        <li>Replace any example data in that file with your description of new 
            DNA constructs -- one construct per row. Do not change table headers.
        </li>

        <li>Upload this file here.</li>
        
        <li>
            Verify that you get a 'successful import' kind of message. 
        </li>
    </ol>
    If there is any
        problem with <em>any</em> of the entries in the file, <em>nothing</em>
        from the file will be imported.
    </p>
    
    <h3>Notes about the Excel file:</h3>
    <p>
    <ul>
        <li>The ID of each new entry must be unique and not yet existing.</li>
        <li>Plasmids, vector backbones or similar references are linked by 
        specifying their ID. Capitalization matters (usually, IDs should be all
        lower case).</li>
        <li>Markers can be referenced by their ID or by their Name (but by ID is safer).</li>
        <li>Entries referenced by ID must already be registered in the system.
        You cannot create them in the same Excel table.</li>       
    </ul>
    </p>
    
    <p><br></p>

    <!-- Upload form. Note enctype attribute! -->
    <form action="{% url "upload_"|add:model_name %}" method="post" enctype="multipart/form-data">
        {% csrf_token %}
        <p>{{ form.non_field_errors }}</p>
        <p>{{ form.tableFile.label_tag }} {{ form.tableFile.help_text }}</p>
        <p>
                {{ form.tableFile.errors }}
                {{ form.tableFile }}
        </p>
        <p><input type="submit" value="Upload" /></p>
    </form>
                
{% endblock %}
