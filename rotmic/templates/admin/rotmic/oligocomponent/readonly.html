{% extends "admin/base_site.html" %}
{% load i18n admin_static admin_list %}
{% load admin_urls %}
{% load rotmicfilters %}

{% block extrastyle %}
    {{ block.super }}
    <link rel="stylesheet" type="text/css" href="{% static "dashboard.css" %}" />
{% endblock %}

{% if not is_popup %}
    {% block breadcrumbs%}<div class="breadcrumbs">
      <a href="../../../">Home</a> &rsaquo;
      <a href="../../">Rotmic</a> &rsaquo;
      <a href="../">Oligos</a> &rsaquo;
      {{ o.displayId }}
    </div>
    {% endblock %}
{% endif %}

{% block coltype %}colMS{% endblock %}
{% block bodyclass %}change-list{% endblock %}  {# keeps center scalable #}

{% block title %}Oligo {{o.displayId}}{% endblock %} {# window title #}

{% block content %}

    {%block title-image%}
        <img src="{% static "img/oligo.jpg" %}" align="left" height="45" 
        style="padding-left:0px; padding-right:10px; padding-top:0px; padding-bottom:5px"> 
    {%endblock%}

    <h3>Oligonucleotide</h3><h1>{{o}}</h1>

    {% block object-tools %}
    {% if not is_popup %}
      <ul class="object-tools">
        {% block object-tools-items %}
        <li><a href="{% url opts|admin_urlname:'history' o.pk|admin_urlquote %}" class="historylink">{% trans "History" %}</a></li>
        <li><a href="edit">Edit</a></li>
        {% endblock %}
      </ul>
    {% endif %}
    {% endblock %}

    <div id="content-main">
    
        <div class='module'>
            <h2>Details</h2>
            
            <p><ul>
                <li><b>Length:</b> {% if o.sequence %}{{o.sequence|length}}{%else%} 0{%endif%} bp</li>
                <li><b>Tm:</b> {{o.meltingTemp}} C</li>
            </ul><p>

            {% if o.comment %}
                <div style="width: 100%; height: 1px;background: lightgrey; text-align: center;"><h4>Physical Details</h4></div>
                <p><br></p>
                <div>
                    <p class='description'>
                        {{o.comment|markdown}}
                    </p>
                </div>
            {% endif %}
    
            {% if o.attachments.count != 0 %}
                <div style="width: 100%; height: 1px;background: lightgrey; text-align: center;"><h4>Attachments</h4></div>
                <p><br></p>
        
                <div>
                        <table border="0" rules="none">
                            <tr>
                                {% for a in o.attachments.all %}
                                    <th style="text-align: center;">
                                        <a href="{{a.f.url}}">{{a}}</a> <br>
                                    </th>
                                    <th></th>
                                {% endfor %}
                            </tr>
                            <tr>
                                {% for a in o.attachments.all %}
                                    <td style="text-align: center;">{{a.description}} ({{a.f.size|filesizeformat}})</td> 
                                    <td></td>
                                {% endfor %}
                            </tr>
                        </table>
                </div>
            {% endif %}
        </div>


        <div class='module'>        
            <h2>DNA Sequence</h2>
            <p>{{o.sequence}}</p>

        
        </div>
        
<!--        <div class='module'>-->
<!--            <h2>Samples</h2>-->
<!--                <p><br></p>-->
<!--                <ul class="object-tools">-->
<!--                    <li><a href="{% url 'admin:rotmic_cellsample_add'%}?cell={{o.pk}}">Add Cell Sample</a></li>-->
<!--                </ul>-->
<!---->
<!--                {% with n=o.cell_samples.count %}-->
<!--                    {% if n > 0 %}-->
<!--                        <p>-->
<!--                            There are <b>{{n}} Cell samples</b> registered for this Cell or Strain.<br>-->
<!--                        </p>-->
<!--                        -->
<!--                        <div style="margin: 10px">-->
<!--                            <table cellspacing="1">-->
<!--                    -->
<!--                                <thead>-->
<!--                                <tr>-->
<!--                                    <th>location</th>-->
<!--                                    <th>ID/<br>Pos.</th><th>prepared</th><th>by</th>-->
<!--                                    <th>Type</th><th>Content</th>-->
<!--                                    <th>Description</th><th>Status</th>-->
<!--                                </tr>-->
<!--                                </thead>-->
<!--                    -->
<!--                                <tbody>-->
<!--                                {% for x in o.cell_samples.all %}-->
<!--                                -->
<!--                                  <tr class="{% cycle 'row1' 'row2' %}">-->
<!--                                  -->
<!--                                    <td>{{x.container.showVerbose}}</td>-->
<!--                                                         -->
<!--                                    <td><b><a href="{{x.get_absolute_url}}">{{x.displayId}}</a></b></td>-->
<!--                                    -->
<!--                                    <td>{{x.preparedAt}}</td>-->
<!--                                    -->
<!--                                    <td>{{x.registeredBy}}</td>-->
<!--                                    -->
<!--                                    <td>{{x.showType}}</td>-->
<!--                                    -->
<!--                                    <td>{{x.showContent}}</td>-->
<!--                                    -->
<!--                                    <td>{{x.comment | truncateHTML:30}}</td>-->
<!--                                    -->
<!--                                    <td>{{x.status}}</td>-->
<!--                                    -->
<!--                                  </tr>-->
<!--                    -->
<!--                              {% endfor %}-->
<!--                              </tbody>-->
<!--                            </table>-->
<!--                            <p></p>-->
<!--                            <small>-->
<!--                                Help: Move mouse over content link to see content description. -->
<!--                                Move mouse over sample description to see full length description.-->
<!--                            </small>-->
<!--                        </div>-->
<!--                    -->
<!--                    {% else %}-->
<!--                        <p>There are no cell samples registered for this cell or strain.</p>-->
<!--                    {% endif %}-->
<!--                {% endwith %}-->
<!--        </div>-->

    </div>

{% endblock %}

{% block sidebar %}
    <div id="content-related">

        <div class="module" id="rating-module">
            <h2>Rating</h2>
            <p>Not implemented</p>
        </div>

        <div class="module" id="classification-module">
            <h2>Classification</h2>
                <p> 
                {% with o.componentType as T %}
                    <a href="../?componentType__id_exact={{T.id}}">{{T}}</a><br>
                {% endwith %}
                </p>
        </div>

        <div class="module" id="record-module">
            <h2>Record</h2>
            <ul>    
                <li><B>Status</B>:<p>{{o.status}}</p></li>
                <li><B>registered</B>: 
                    <p>
                    {% with o.registeredBy as U %}
                        {{o.registrationDate}}; &nbsp{{o.registrationTime}}<br>
                        by <a href="../?registeredBy__id__exact={{U.id}}">
                            {{U.first_name}} {{U.last_name}} ({{U}})</a>
                    {% endwith %}
                    </p>
                </li>
                {% if o.modifiedBy %}
                    <li><B>last modified</B>: 
                        <p>
                        {% with o.modifiedBy as U %}
                            {{o.modificationDate}}; &nbsp{{o.modificationTime}}<br>
                            by {{U.first_name}} {{U.last_name}} ({{U}})
                        {% endwith %}
                        </p>
                    </li>
                {% endif %}   
            </ul>
        </div> 

    </div>
{% endblock %}

