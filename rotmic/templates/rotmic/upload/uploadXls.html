{% extends "rotmic/upload/uploadGbk.html" %}
{% load i18n admin_static rotmicforms %}

{% block last-breadcrumb %}Upload Table{% endblock %}

{% block actionurl %}{% url "upload_"|add:model_name %}{% endblock %}

{%block help-link%}
    <a href="http://rotmic.iric.ca/wiki/UserGuide/Dialogs/upload-xls" class="helplink">{% trans "Help!" %}</a>
{% endblock %}

{%block form-title%}<h2>Bulk upload of {{verbose_name}}s</h2>{% endblock %}
    
{% block form-fieldsets %}
    <fieldset class="module">
        <h2>Instructions</h2>
        <p>
            This form allows you to create several <b>new</b> {{verbose_name}} entries
            at once. This is how it works:
            <ol>
                <li>Click to <a href="{% static 'uploadexample_'|add:model_name|add:'.xlsx'%}">
                            download the Excel template file.</a>
                </li>
        
                <li>Replace any example data in that file with your description of new 
                    entries -- one entry per row. Do not change table headers.
                </li>
        
                <li>Upload this file here.</li>
                
                <li>
                    Verify that you get a 'successful import' kind of message. 
                </li>
            </ol>
            
            If there is any
                problem with <em>any</em> of the entries in the file, <em>nothing</em>
                from the file will be imported.
        </p>
    
        <h3>Notes about the Excel file:</h3>
        <p>
        <ul>
            <li>The ID of each new entry must be unique and not yet existing.</li>
            <li>References (e.g. the vectorBackbone of a DNA construct) are linked by 
            specifying their ID. Capitalization matters (usually, IDs should be all
            lower case).</li>
            <li>More detailed instructions are in the Excel file itself.</li>
        </ul>
        </p>

    </fieldset>
    
    <fieldset class="module">
        <h2>Select File</h2>
        <p>Now, having read all that, please select an Excel file.</p>

        {% formrow form.tableFile %}
        
    </fieldset>

{% endblock %}